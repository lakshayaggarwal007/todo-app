<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TO-DO app</title>
    <!-- bootstrap -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous"> -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
<link rel="stylesheet" href="./index.css">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/3.1.4/css/bootstrap-datetimepicker.min.css">


<!-- jquery css  -->
<link rel="stylesheet" href="./jquery-ui.min.css">
<link rel="stylesheet" href="./jquery-ui.structure.min.css">
<link rel="stylesheet" href="./jquery-ui.theme.min.css">
<!-- jquery -->
<link href = "https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css"
         rel = "stylesheet">
      <script src = "https://code.jquery.com/jquery-1.10.2.js"></script>
      <script src = "https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
      
      <!-- Javascript -->
      <script>
        //  data 

        var data =      [
                //   { label: "name1", value: "date-time1" ,id :1},
                //   { label: "name2", value: "date-time2" ,id :2}
               ]
        
        // search start 
      
      
         $(function() {
            $( "#search" ).autocomplete({
               source: data
            });
         });
        //  search end 



        // add data 
    function adddata(){
       if (document.getElementById("name1").value !== "" && document.getElementById("date-time").value !==""){
       index = data.length +1;
       var name1 = document.getElementById("name1").value 
       var datetime = document.getElementById("date-time").value
        var obj = { label: name1 , value: datetime, id: index }; 
        data.push(obj); 
        
        
        
        if (document.getElementById("select").value == "recent"){
        
        
        data.sort(function(a, b){return b.id - a.id});
        let output = ``

data.map(r => {
 output += `<tr>
     <th scope="row" hidden>${r.id}</th>
     <td><input type="text" value="${r.label}" size="20" class="inputname" id="${r.id}" disabled></td>
     <td><input type="text" value="${r.value}" size="20" class="date-time2" id="${r.id}-date-time" disabled></td>
     <td>
         
             <button type="button" class="btn btn-outline-warning edit-btn" name ="edit-btn"><img src="./edit.png" alt="delete" width="20" onclick="reply_click(this.id)" id="${r.id}"></button>
             <button type="button" class="btn btn-outline-danger delete-btn" name ="delete-btn" ><img src="./1345874.png" alt="delete" width="20" onclick="deleteRow(this)"></button>    
             
             
     </td>  
   </tr>`
})
document.getElementById("tbody").innerHTML =output;
document.getElementById("name1").value = ""
   
document.getElementById("date-time").value = ""
} 
        
}

if (document.getElementById("select").value == "old" ||document.getElementById("select").value == "sort" ){
  data.sort(function(a, b){return a.id - b.id});
  
        let output = ``

data.map(r => {
 output += `<tr>
     <th scope="row" hidden>${r.id}</th>
     <td><input type="text" value="${r.label}" size="20" class="inputname" id="${r.id}"   disabled></td>
     <td><input type="text" value="${r.value}" size="20" class="date-time2" id="${r.id}-date-time" disabled></td>
     <td>
         
             <button type="button" class="btn btn-outline-warning edit-btn" name ="edit-btn"><img src="./edit.png" alt="delete" width="20" onclick="editRow(this) ; " id="${r.id}"></button>
             <button type="button" class="btn btn-outline-danger delete-btn" name ="delete-btn" ><img src="./1345874.png" alt="delete" width="20" onclick="deleteRow(this)"></button>    
             
             
     </td>  
   </tr>`
})
document.getElementById("tbody").innerHTML =output;
document.getElementById("name1").value = ""
   
document.getElementById("date-time").value = ""


}


}
	
   //  value ="${r.id}" id ="${r.id}"
	     
    // add data end 


// delete data start 
function deleteRow(r) {

    // console.log(document.getElementById("3").value)
  var i = r.parentNode.parentNode.parentNode.rowIndex;

 document.getElementById("myTable").deleteRow(i);
 
 console.log(data.length)
 data.splice(i-1,1);
 console.log(data.length)

 if (data.length == 0) {
        
        
        let norecord = ``


 norecord += `<tr>
     <th scope="row"></th>
     <td>no record found</td>
     <td></td>
     <td>
         
            
             
         
     </td>
   </tr>`

document.getElementById("tbody").innerHTML =norecord;
} 
}
// let del_index = document.getElementsByName("delete-btn").id ;





// $(document).ready(function(){
//     alert($("*[name='delete-btn']").attr('id'));
// });



// delete data end    

// edit data recent start



function reply_click(clicked_id)
  {

    document.getElementById(`${clicked_id}`).disabled = false;
    document.getElementById(`${clicked_id}-date-time`).disabled = false;
    document.getElementById(clicked_id).focus();
    console.log(clicked_id)

    $( `#${clicked_id}`)
  .focusout(function() {
    
    $( `#${clicked_id}` ).prop('disabled', true);
    var val = document.getElementById(`${clicked_id}`).value
    
    objIndex = data.findIndex((obj => obj.id == clicked_id));
    // if (objIndex == 0){
    //   var index = 0;
    // };
    

    data[objIndex].label = val;
   
    

  });



$( `#${clicked_id}-date-time`)
  .focusout(function() {

    $( `#${clicked_id}` ).prop('disabled', false);
    $( `#${clicked_id}-date-time` ).prop('disabled', true);
    var val2 = document.getElementById(`${clicked_id}-date-time`).value
 
    objIndex = data.findIndex((obj => obj.id == clicked_id));
    // if (objIndex == 0){
    //   var index = 0;
    // };
   

   
    data[objIndex].value = val2;



  });


      // alert(clicked_id);
  }

// edit data recent end 
 
// edit data start 

function editRow(r){
    var i = r.parentNode.parentNode.parentNode.rowIndex;
    document.getElementById(`${i}`).disabled = false;
    document.getElementById(`${i}-date-time`).disabled = false;
    


    if (document.getElementById("select").value == "recent"){
      
      
      
  
      
      // console.log(element_id);
      // document.getElementById(i).focus();
   


    }else{


      document.getElementById(i).focus();
    }
    


    //  data.filter(function (el)
    // {
    //     {
    //         document.getElementById(i).value = el.label; 
    //     }
      
             
             
    // }
    // );
  
  //  edit-date-time-picker 

    $(function(){

$(`#${i}-date-time`).datetimepicker({
  format: "DD/MM/YYYY hh:mm:ss A",
  useSeconds: true
});

});

// edit date-time-picker end 

// edit focus out 
$( `#${i}`)
  .focusout(function() {
    
    $( `#${i}` ).prop('disabled', true);
    var val = document.getElementById(`${i}`).value
    
    objIndex = data.findIndex((obj => obj.id == i));
    // if (objIndex == 0){
    //   var index = 0;
    // };
    

    data[objIndex].label = val;
   
    

  });



$( `#${i}-date-time`)
  .focusout(function() {

    $( `#${i}` ).prop('disabled', false);
    $( `#${i}-date-time` ).prop('disabled', true);
    var val2 = document.getElementById(`${i}-date-time`).value
 
    objIndex = data.findIndex((obj => obj.id == i));
    // if (objIndex == 0){
    //   var index = 0;
    // };
   

   
    data[objIndex].value = val2;



  });

}

// edit focusout end 



// edit data end 



// search particular value start 
function search(){


   var search_value = document.getElementById("search").value ;
   
        
    
var condition = new RegExp(search_value);



var result = data.filter(function (el) {
  return condition.test(el.label);
});

console.log(result);
    
if (result.length == 0) {
    console.log(result);    
        
        let norecord = ``


 norecord += `<tr>
     <th scope="row"></th>
     <td>no result found</td>
     <td></td>
     <td>
         
            
             
         
     </td>
   </tr>`

document.getElementById("tbody").innerHTML = norecord;
} 



var tableHeaderRowCount = 1;
    var table = document.getElementById('myTable');
    var rowCount = table.rows.length;
    for (var i = tableHeaderRowCount; i < rowCount; i++) {
        table.deleteRow(tableHeaderRowCount);
    }
    let output = ``
   
    result.map(r => {
 output += `<tr>
     <th scope="row" hidden>${r.id}</th>
     <td><input type="text" value="${r.label}" size="20" class="inputname"   id="${r.id}" disabled></td>
     <td><input type="text" value="${r.value}" size="20" class="date-time2" id="${r.id}-date-time" disabled  ></td>
     <td>
         
             <button type="button" class="btn btn-outline-warning edit-btn" name ="edit-btn"><img src="./edit.png" alt="delete" width="20" onclick="editRow(this) ; " id="${r.id}"></button>
             <button type="button" class="btn btn-outline-danger delete-btn" name ="delete-btn" ><img src="./1345874.png" alt="delete" width="20" onclick="deleteRow(this)"></button>    
             
             
     </td>  
   </tr>`
})
document.getElementById("tbody").innerHTML =output;


}



      </script>

 
</head>
<body>
    <div class="container text-center">
        <div class="row">
          <div class="col"></div>
          <div class="col">
             <h1><img src="images.png" alt="to-do"></h1>
          </div>
          <div class="col"></div>
        </div>
    </div>
    <div class="container text-center">
        <div class="row">
          <div class="col-md-10">
            <input class="form-control me-2 " type="search" placeholder="Search" aria-label="Search" id ="search">
        
          </div>
          <div class="col-md-2">
            <button type="button" class="btn btn-outline-primary " id ="search-btn" onclick="search()">search</button>
          </div>
        </div>
      </div>
      <div class="container text-center">
        <div class="row">
            <div class="col-sm-4">
                <input type="text" class="form-control name-input" id="name1" name= "name1" placeholder="Enter name" autocomplete="off" autofocus>
            </div>
            <div class="col-sm-4">
                
                <input type="text" class="form-control" id="date-time" placeholder="select date" autocomplete="off" >
            </div>
            <div class="col-sm-2">
                
               
                    <button type="button" id ="add" class="btn btn-success" onclick="adddata()">Add</button>
                  
            </div>  
          <div class="col-sm-2">
            <select name="cars" id="select" class="btn select " onchange="recent()">
                <option value="sort">sort</option>
                <option value="recent" >recent</option>
                <option value="old">old</option>
              </select>
        </div>
      </div>  
      <script>


// sort data recent 
        function recent(){
if (document.getElementById("select").value == "recent"){
var sorteddata = data.slice();

data.splice(0);
sorteddata.sort(function(a, b){return b.id - a.id});

//    var data = sorteddata.slice();
//    sorteddata.splice(0);
    console.log(sorteddata);
    console.log(data);
    var tableHeaderRowCount = 1;
    var table = document.getElementById('myTable');
    var rowCount = table.rows.length;
    for (var i = tableHeaderRowCount; i < rowCount; i++) {
        table.deleteRow(tableHeaderRowCount);
    }
    let output = ``
    data = sorteddata.slice();
    sorteddata.splice(0);
 data.map(r => {
 output += `<tr>
     <th scope="row" hidden>${r.id}</th>
     <td><input type="text" value="${r.label}" size="20" class="inputname"  id="${r.id}" disabled></td>
     <td><input type="text" value="${r.value}" size="20" class="date-time2" id="${r.id}-date-time" disabled ></td>
     <td>
         
             <button type="button" class="btn btn-outline-warning edit-btn" name ="edit-btn"><img src="./edit.png" alt="delete" width="20" id="${r.id}" onClick=" reply_click(this.id)" ></button>
             <button type="button" class="btn btn-outline-danger delete-btn" name ="delete-btn" ><img src="./1345874.png" alt="delete" width="20" onclick="deleteRow(this)"></button>    
             
             
     </td>  
   </tr>`
})
document.getElementById("tbody").innerHTML =output;
// 


if (data.length == 0) {
        
        
        let norecord = ``


 norecord += `<tr>
     <th scope="row"></th>
     <td>no record found</td>
     <td></td>
     <td>
         
            
             
         
     </td>
   </tr>`

document.getElementById("tbody").innerHTML =norecord;
} 

}
// sort data recent end

// sort data old 
if (document.getElementById("select").value == "old" ||document.getElementById("select").value == "sort" ){

console.log(sorteddata)


var sorteddata = data.slice();

data.splice(0);
sorteddata.sort(function(a, b){return a.id - b.id});

//    var data = sorteddata.slice();
//    sorteddata.splice(0);
    console.log(sorteddata);
    console.log(data);
    var tableHeaderRowCount = 1;
    var table = document.getElementById('myTable');
    var rowCount = table.rows.length;
    for (var i = tableHeaderRowCount; i < rowCount; i++) {
        table.deleteRow(tableHeaderRowCount);
    }
    let output = ``
    data = sorteddata.slice();
    sorteddata.splice(0);
 data.map(r => {
 output += `<tr>
     <th scope="row" hidden>${r.id}</th>
     <td><input type="text" value="${r.label}" size="20" class="inputname"  id="${r.id}" disabled></td>
     <td><input type="text" value="${r.value}" size="20" class="date-time2"  id="${r.id}-date-time" disabled ></td>
     <td>
         
             <button type="button" class="btn btn-outline-warning edit-btn" name ="edit-btn"><img src="./edit.png" alt="delete" width="20" onclick="editRow(this) ;  " id="${r.id}"></button>
             <button type="button" class="btn btn-outline-danger delete-btn" name ="delete-btn" ><img src="./1345874.png" alt="delete" width="20" onclick="deleteRow(this)"></button>    
             
             
     </td>  
   </tr>`
})
document.getElementById("tbody").innerHTML =output;
if (data.length == 0) {
        
        
        let norecord = ``


 norecord += `<tr>
     <th scope="row"></th>
     <td>no record found</td>
     <td></td>
     <td>
         
            
             
         
     </td>
   </tr>`

document.getElementById("tbody").innerHTML =norecord;
} 

// sort data old end 


}
}

      </script>
    <table class="table table-striped" id ="myTable">
        <thead class="thead-light">
          <tr>
            <th scope="col" style="width: 10%" hidden>#</th>
            <th scope="col" style="width: 30%">Name</th>
            <th scope="col" style="width: 30%">Date-Time</th>
            <th scope="col" style="width: 30">Action</th>
          </tr>
        </thead>
        <tbody id = "tbody">
            
          <!-- <tr>
            <th scope="row">1</th>
            <td>Mark</td>
            <td>Otto</td>
            <td>
                
                    <button type="button" class="btn btn-outline-warning edit-btn">Edit</button>
                    <button type="button" class="btn btn-outline-danger delete-btn" ><img src="./1345874.png" alt="delete" width="20"></button>
                    
                
            </td>
          </tr> -->
        <script>
        //    no record found 
            if (data.length == 0) {
        
        
        let norecord = ``


 norecord += `<tr>
     <th scope="row"></th>
     <td>no record found</td>
     <td></td>
     <td>
         
            
             
         
     </td>
   </tr>`

document.getElementById("tbody").innerHTML =norecord;
} 
//   no record found end 




// if (document.getElementById("select").value =="sort"){

// data.sort(function(a, b){return a.id - b.id});
// console.log(data)

// }


        </script>
        </tbody>
      </table>
      <div class="container text-center">
        <div class="row">
          <div class="col">
            
          </div>
          <div class="col" id ="norecord">
            
          </div>
          <div class="col">
            
          </div>
        </div>
      </div>
      
 
</body>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment-with-locales.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/3.1.4/js/bootstrap-datetimepicker.min.js"></script>

     
      <script>
        $(function(){

$('#date-time').datetimepicker({
  format: "DD/MM/YYYY hh:mm:ss A",
  useSeconds: true
});

});







    </script>

</html>